import os, psycopg2, time
pg_url = os.environ.get("DATABASE_URL")
print(f"URL: {pg_url}")
conn = psycopg2.connect(pg_url)
cur = conn.cursor()
cur.execute("TRUNCATE TABLE usuarios RESTART IDENTITY CASCADE")
cur.execute("INSERT INTO usuarios (id, username, password_hash, role, is_active, is_admin, must_change_password) VALUES (1, 'persistent', 'hash', 'admin', True, True, False)")
conn.commit()
print("Committed. Checking count inside...")
cur.execute("SELECT count(*) FROM usuarios")
print(f"Count: {cur.fetchone()[0]}")
print("Sleeping for 30s... check now!")
time.sleep(30)
conn.close()
